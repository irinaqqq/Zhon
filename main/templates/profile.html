{% extends 'base.html' %} 
{% load static %} 
{% block title %}Profile{% endblock %} 
 
{% block content %} 
    <div class="container" style="background-color: #ead09a;">
        <div class="tabcontent" id="main">
            <div class="main-1">
                <div class="pfp1">
                    <div style="background-color: rgb(0,0,0,0.3);"></div>
                    <div style="margin: -30.5vh 0 0 -0.4vh;">
                        <img class="profile-pic" src="{% if profile_pic %}
                            {{ profile_pic }}
                        {% else %}
                            {% static 'img/pfp.png' %}
                        {% endif %}">
                    </div>
                    <button><img src="{% static 'img/edit.svg' %}"></button>
                </div>
                <h2 class="user-inf">{{ profile_info.get_name }}</h2>
                <h2 class="user-inf">ID: {{ profile_info.get_id }}</h2>
                <div class="user-activity">
                    <h3>Белсенділік</h3>
                    <ul>
                        <li>Тоқтамай: <span>3 күн</span></li>
                        <li>Рекорд: <span>47 күн</span></li>
                        <li>Оқылған беттер: <span>0 бет</span></li>
                        <li>Барлығы: <span>777 сағат 88 минут</span></li>
                    </ul>
                </div>
            </div>

            <div class="main-2">
                <div class="user-progress">
                    <div class="prog-card-in">
                        <h2>Жетістіктер</h2>
                        <div class="prog-nums">
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>

                    <div class="main-2-out">
                        <div class="main-2-in">
                            <button id="up-main-2" class="prev nav-btn" onclick="changeClassroom('previous')">
                                <span>&#9650</span>
                            </button>
                            <div class="main-2-cl-name"><h3 class="cl-name-h2">Class name</h3></div>
                            </button>
                            <button id="up-main-2" class="next nav-btn" onclick="changeClassroom('next')">
                                <span>&#x25BC;</span>
                            </button>
                        </div>
                        <div class="card-in1">
                            <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>1</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>2</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>3</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>4</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>5</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>6</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>7</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>8</p>
                            </div>
                            <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                                <div class="ind-prog"><div style="height: 80%;"></div></div>
                                <p>9</p>
                            </div>
                    </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="tabcontent" id="progress">
            <div class="prog">
                <div class="prog-card first-prog-card">
                    <div class="prog-card-in">
                        <button><div id="shadow"></div><div></div></button>
                        <div class="prog-nums">
                            <div class="pr-name"><h2>Grade name</h2></div>
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <div class="rating">
                                <div style="background-color: #F52338;">&#9733;&#9733;&#9733;</div>
                                <div style="background-color: #FF6661;">&#9733;&#9733;</div>
                                <div style="background-color: #FF9492;">&#9733;</div>
                                <div style="background-color: #FFc2c2; color: rgba(0,0,0,0.3);">&#9733;</div>
                            </div>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>
                    <div class="card-in1">
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                    </div>
                </div>
                <div class="prog-card second-prog-card">
                    <div class="prog-card-in">
                        <button><div id="shadow"></div><div></div></button>
                        <div class="prog-nums">
                            <div class="pr-name"><h2>Grade name</h2></div>
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <div class="rating">
                                <div style="background-color: #Fa7e37">&#9733;&#9733;&#9733;</div>
                                <div style="background-color: #FB975E">&#9733;&#9733;</div>
                                <div style="background-color: #FCB187">&#9733;</div>
                                <div style="background-color: #FDCBAF; color: rgba(0,0,0,0.3)">&#9733;</div>
                            </div>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>
                    <div class="card-in1">
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                    </div>
                </div>
                <div class="prog-card third-prog-card">
                    <div class="prog-card-in">
                        <button><div id="shadow"></div><div></div></button>
                        <div class="prog-nums">
                            <div class="pr-name"><h2>Grade name</h2></div>
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <div class="rating">
                                <div style="background-color: #267F26">&#9733;&#9733;&#9733;</div>
                                <div style="background-color: #3D993D">&#9733;&#9733;</div>
                                <div style="background-color: #6BB26B">&#9733;</div>
                                <div style="background-color: #A3CCA3; color: rgba(0,0,0,0.3)">&#9733;</div>
                            </div>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>
                    <div class="card-in1">
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                    </div>
                </div>
                <div class="prog-card forth-prog-card">
                    <div class="prog-card-in">
                        <button><div id="shadow"></div><div></div></button>
                        <div class="prog-nums">
                            <div class="pr-name"><h2>Grade name</h2></div>
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <div class="rating">
                                <div class="3-star" style="background-color: #3299cc">&#9733;&#9733;&#9733;</div>
                                <div class="2-star" style="background-color: #5AADD6">&#9733;&#9733;</div>
                                <div class="1-star" style="background-color: #84C1E0">&#9733;</div>
                                <div class="0-star" style="background-color: #ADD6EA; color: rgba(0,0,0,0.3)">&#9733;</div>
                            </div>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>
                    <div class="card-in1">
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                    </div>
                </div>
                <div class="prog-card fifth-prog-card">
                    <div class="prog-card-in">
                        <button><div id="shadow"></div><div></div></button>
                        <div class="prog-nums">
                            <div class="pr-name"><h2>Grade name</h2></div>
                            <p>777 <img src="/static/img/star.svg"></p>
                            <p>888 <img src="/static/img/cup.svg"></p>
                            <p>444,000  <span>XP</span></p>
                            <div class="rating">
                                <div class="3-star" style="background-color: #84318C">&#9733;&#9733;&#9733;</div>
                                <div class="2-star" style="background-color: #9C5AA3">&#9733;&#9733;</div>
                                <div class="1-star" style="background-color: #B583BA">&#9733;</div>
                                <div class="0-star" style="background-color: #C198C5; color: rgba(0,0,0,0.3)">&#9733;</div>
                            </div>
                            <p class="cl-num">222/555 Сабақ</p>
                        </div>
                    </div>
                    <div class="card-in1">
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                        <div class="ind" style="clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);">
                            <div class="ind-prog"><div style="height: 80%;"></div></div>
                            <p>1</p>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>
        </div>

        <div class="tabcontent" id="activity">
            <div class="activity-container">
                <div class="calendar-out">
                    <div class="calendar">
                        <div class="month"><a href="#" class="nav">◀</a><div> <span class="year"></span></div><a href="#" class="nav">▶</a></div>
                        <div class="days">
                            <span>Дүй</span>
                            <span>Сей</span>
                            <span>Сәр</span>
                            <span>Бей</span>
                            <span>Жұм</span>
                            <span>Сен</span>
                            <span>Жек</span>
                        </div>
                        <div class="dates"></div>
                    </div>
                    <div class="calendar-details">
                        <p class="calendar-details-text"></p>
                        <div class="activity-time">
                            <img src="/static/img/clock.svg">
                            <h5>Барлығы <span>{{ total_time_spent }} минут</span></h5>
                            <p>Өтілді <span>22 минут</span></p>
                            <p>Оқылды <span>22 минут</span></p>
                        </div>
                        <div class="activity-star">
                            <img src="/static/img/star.svg">
                            <h5>Алынды <span>555 жұлдыз</span></h5>
                        </div>
                    </div>
                </div>
                <div class="activity-card">
                    <h2><img class="title-img" src="/static/img/school.svg"> Өтілген Сабақтар</h2>
                    <p><span style="color: #84318C">Class name</span><img src="/static/img/star.svg" style="position: absolute; right: 50vh"><span style="position: absolute; right: 20vh">7 есеп</span><span style="position:absolute;right: 0">9 мин</span></p>
                    <p><span style="color: #84318C">Claffffffffffffffffffffffffss name</span><img src="/static/img/star.svg" style="position: absolute; right: 50vh"><span style="position: absolute; right: 20vh">7hj есеп</span><span style="position:absolute;right: 0">999 мин</span></p>
                </div>
                <div class="activity-card">
                    <h2><img class="title-img" src="/static/img/school.svg"> Оқылған Бөлімдер</h2>
                    <p><span style="color: #84318C">Class name</span><span style="position:absolute;right: 0">9 мин</span></p>
                    <p><span style="color: #84318C">Claffffffffffffffffffffffffss name</span><span style="position:absolute;right: 0">999 мин</span></p>
                </div>
            </div>
        </div>


        <div style="width: 140vh; height: 5vh; background: #FFF1CD; background: linear-gradient(0deg, rgba(255,241,205,1) 24%, rgba(255,241,205,0) 100%); position: fixed; bottom: 10vh"></div>

        <div class="btns">
            <button class="tablink" onclick="openProf('main', this)">
                <div class="pfp1 mini-pfp">
                    <div>
                        <img class="profile-pic" src="{% if profile_pic %}
                            {{ profile_pic }}
                        {% else %}
                            {% static 'img/pfp.png' %}
                        {% endif %}">
                    </div>
                </div>
                <h4>Профайл</h4>
            </button>
            <button class="tablink" onclick="openProf('progress', this)">
                <img src="/static/img/star.svg">
                <h4>Жетістіктер</h4>
            </button>
            <button class="tablink" onclick="openProf('activity', this)">
                <img src="/static/img/calendar.svg">
                <h4>Белсенділік</h4>
            </button>
        </div>

    </div>
<!-- {#    <div class="profile-container">#}
{#        <h1>User Profile</h1>#}
{#        <div class="profile-info">#}
{#            <img src="{{ profile_info.profile_pic.url }}" alt="Profile Picture" class="profile-pic">#}
{#            <p>Name: {{ profile_info.get_name }}</p>#}
{#            <p>User ID: {{ profile_info.get_id }}</p>#}
{#        </div>#}
{#        <div class="progress-info">#}
{#            {% for classroom_progress in classroom_progress %}#}
{#            <h3>{{ classroom_progress.classroom.name }}</h3>#}
{#            <p>Progress Percentage: {{ classroom_progress.progress_percentage }}%</p>#}
{#            <p>Completed Tasks: {{ classroom_progress.completed_tasks_count }}</p>#}
{#        {% endfor %}#}
{#        #}
{#            <h2>Tasks Completed</h2>#}
{#            <ul>#}
{#                {% for item in tasks_count_by_date %}#}
{#                    <li>{{ item.completion_date|date:'j F Y' }}: Solved {{ item.count }} task{% if item.count != 1 %}s{% endif %}</li>#}
{#                {% endfor %}#}
{#            </ul>#}
{#        </div>#}
{#    </div>#} -->

{% endblock %} 
{% block extra_scripts %}

<script>
        function openProf(profName, elmnt) {
            // Hide all tabcontent elements
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none"; // Hide all
                tabcontent[i].classList.remove("active"); // Remove 'active' class
            }

            // Display the specific tabcontent and mark as active
            var activeTab = document.getElementById(profName);
            activeTab.style.display = "flex"; // Show active tab
            activeTab.classList.add("active"); // Add 'active' class

            tablinks = document.getElementsByClassName("tablink");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].style.backgroundColor = "#0659A6";
                tablinks[i].style.borderColor = '#408FCC';
            }

            elmnt.style.backgroundColor = '#16ACF3';
            elmnt.style.borderColor = '#fff6e5';
        }

        document.getElementsByClassName("tablink")[0].click();

        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('.prog-card-in button');

            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    const progCard = this.closest('.prog-card');
                    const shadow = this.querySelector('#shadow');  // Target the #shadow element
                    const innerDiv = this.querySelector('div:nth-child(2)');  // Second child div inside button

                     if (progCard) {
                        const cardIn = progCard.querySelector('.card-in1');

                        if (cardIn.style.display == 'flex') {
                            cardIn.style.display = 'none';
                            shadow.classList.remove('rotate-90');  // Rotate back to initial state
                            innerDiv.classList.remove('rotate-90');
                        } else {
                            cardIn.style.display = 'flex';
                            shadow.classList.add('rotate-90');  // Rotate to 90 degrees
                            innerDiv.classList.add('rotate-90');
                        }
                    }
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
    const calendar = document.querySelector('.calendar');
    const datesContainer = calendar.querySelector('.dates');
    const monthDisplay = calendar.querySelector('.month div');
    const calendarDetails = document.querySelector('.calendar-details-text');
    const prevButton = calendar.querySelector('.nav:nth-child(1)');
    const nextButton = calendar.querySelector('.nav:nth-child(3)');

    const months = [
        'Қаңтар', 'Ақпан', 'Наурыз', 'Сәуір', 'Мамыр', 'Маусым',
        'Шілде', 'Тамыз', 'Қыркүйек', 'Қазан', 'Қараша', 'Желтоқсан'
    ];
    const weekdays = ['Жексенбі', 'Дүйсенбі', 'Сейсенбі', 'Сәрсенбі', 'Бейсенбі', 'Жұма', 'Сенбі'];

    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();

    function updateCalendar(month, year) {
        datesContainer.innerHTML = '';
        monthDisplay.innerHTML = `${months[month]} <span class="year">${year}</span>`;

        const firstDay = new Date(year, month, 1).getDay();
        const offset = (firstDay === 0) ? 6 : firstDay - 1;

        for (let i = 0; i < offset; i++) {
            const emptySlot = document.createElement('div');
            emptySlot.style.backgroundColor = '#CCCCCC';
            datesContainer.appendChild(emptySlot);
        }

        const totalDays = new Date(year, month + 1, 0).getDate();

        for (let i = 1; i <= totalDays; i++) {
            const button = document.createElement('button');
            button.innerText = i.toString();
            button.style.backgroundColor = '#E6E6E6';

            if (new Date(year, month, i) < today) {
                button.style.backgroundColor = '#FDE477';
            }

            if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                button.classList.add('today');
            }

            button.addEventListener('click', function() {
                const selectedDate = new Date(year, month, i);
                const fullDate = `${weekdays[selectedDate.getDay()]}, ${months[month]} ${i}, ${year}`;
                calendarDetails.innerText = `${fullDate}`;
            });

            datesContainer.appendChild(button);
        }

        const remainingCells = 7 - ((totalDays + offset) % 7);
        if (remainingCells < 7) {
            for (let i = 0; i < remainingCells; i++) {
                const emptySlot = document.createElement('div');
                emptySlot.style.backgroundColor = '#CCCCCC';
                datesContainer.appendChild(emptySlot);
            }
        }
    }

    prevButton.addEventListener('click', function() {
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
        }
        updateCalendar(currentMonth, currentYear);
    });

    nextButton.addEventListener('click', function() {
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
        }
        updateCalendar(currentMonth, currentYear);
    });

    updateCalendar(currentMonth, currentYear);

    // Display today's date and weekday by default in calendar-details
    const todayFullDate = `${weekdays[today.getDay()]}, ${months[today.getMonth()]} ${today.getDate()}, ${today.getFullYear()}`;
    calendarDetails.innerText = `${todayFullDate}`;
});
</script>
{% endblock %} 
